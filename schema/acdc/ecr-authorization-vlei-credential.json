{
  "$id": "EQPojyprTDYHsoXzhbencBqXdBlsEtja1TaF_5yFEu_s",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ECR Authorization vLEI Credential",
  "description": "A vLEI Authorization Credential issued by a Legal Entity to a QVI for the authorization of ECR credentials",
  "credentialType": "ECRAuthorizationvLEICredential",
  "properties": {
    "v": {
      "type": "string"
    },
    "d": {
      "type": "string"
    },
    "u": {
      "description": "one time use nonce",
      "type": "string"
    },
    "i": {
      "description": "LE Issuer AID",
      "type": "string"
    },
    "ri": {
      "description": "credential status registry",
      "type": "string"
    },
    "s": {
      "description": "schema SAID",
      "type": "string"
    },
    "a": {
      "oneOf": [
        {
          "description": "attribute block SAID",
          "type": "string"
        },
        {
          "description": "data block",
          "properties": {
            "d": {
              "type": "string"
            },
            "i": {
              "description": "QVI Issuee AID",
              "type": "string"
            },
            "dt": {
              "description": "issuance date time",
              "format": "date-time",
              "type": "string"
            },
            "AID": {
              "description": "AID of the intended recipient of the ECR credential",
              "type": "string"
            },
            "LEI": {
              "description": "LEI of the requesting Legal Entity",
              "type": "string"
            },
            "personLegalName": {
              "description": "Requested recipient name as provided during identity assurance",
              "type": "string"
            },
            "engagementContextRole": {
              "description": "Requested role description i.e. 'Head of Standards'",
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [
            "i",
            "dt",
            "AID",
            "LEI",
            "personLegalName",
            "engagementContextRole"
          ],
          "type": "object"
        }
      ]
    },
    "e": {
      "oneOf": [
        {
          "description": "edge block SAID",
          "type": "string"
        },
        {
          "description": "edges block",
          "properties": {
            "d": {
              "description": "said of edges block",
              "type": "string"
            },
            "le": {
              "description": "chain to legal entity vLEI credential",
              "properties": {
                "n": {
                  "type": "string"
                },
                "s": {
                  "type": "string",
                  "description": "SAID of required schema of the credential pointed to by this node",
                  "const": "EWJkQCFvKuyxZi582yJPb0wcwuW3VXmFNuvbQuBpgmIs"
                }
              },
              "additionalProperties": false,
              "required": [
                "n",
                "s"
              ],
              "type": "object"
            }
          },
          "additionalProperties": false,
          "required": [
            "d",
            "le"
          ],
          "type": "object"
        }
      ]
    },
    "r": {
      "oneOf": [
        {
          "description": "rules block SAID",
          "type": "string"
        },
        {
          "type": "object",
          "properties": {
            "d": {
              "type": "string",
              "description": "SAID of rules block"
            },
            "usageDisclaimer": {
              "type": "object",
              "description": "Usage Disclaimer",
              "properties": {
                "l": {
                  "description": "associated legal language",
                  "const": "Usage of a valid Legal Entity vLEI Credential does not assert that the Legal Entity is trustworthy, honest, reputable in its business dealings, safe to do business with, or compliant with any laws."
                }
              }
            },
            "issuanceDisclaimer": {
              "type": "object",
              "description": "Issuance Disclaimer",
              "properties": {
                "l": {
                  "description": "associated legal language",
                  "const": "Issuance of a valid Legal Entity vLEI Credential only establishes that the information in the requirements in the Identity Verification section 6.3 of the Credential Governance Framework were met in accordance with the vLEI Ecosystem Governance Framework."
                }
              }
            }
          },
          "additionalProperties": false,
          "required": [
            "d",
            "usageDisclaimer",
            "issuanceDisclaimer"
          ],
          "description": "rules block"
        }
      ]
    }
  },
  "additionalProperties": false,
  "required": [
    "i",
    "ri",
    "s",
    "d",
    "e",
    "r"
  ],
  "type": "object"
}
